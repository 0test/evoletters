# evoLetters

## Работа с модулем:
Вкладка подписчики, думаю, тут ве понятно, однако две ремарки:
1. Если вы решите добавить какие-то поля в табличку el_subscriber, то просто расширьте ее и в папке /templates/ создайте home.custom.tpl
2. Есть столбец "Верифицирован". Эта галка становится если пропустить базу подписчиков через сервис quickemailverification.com Для этого нужно сделать рассылку письма "Валидация писем"

Шаблоны. [+content+] - тело письма. [+unscribe_link+] - ссыль на отписку. Знает и понимает глобальные переменные конфигурации, умеет выполнять сниппеты.

Письма - все понятно.

Методы - сюда вписываем название и название сниппета, который будет заниматься непосредственной отправкой конретному пользователю.
Предустановлено четыре метода:
1. modxmail - отправка через $modx->mail;
2. smtp.bz - сервис позволяющий производить отправку через curl. Нужна регистрация.
3. smsc - в представлении, думаю не нуждается. Нужна регистрация.
4. emailverification - сервис позволяющий отсечь заведомо "левые" ящики.

Сама рассылка производится путем выбора письма и нажатием на кнопку произвести рассылку.

## Сниппет:

&subscribe_form - форма подписки. Поле subscribe_email - единственное обязательное. 
(По умолчанию: @CODE: <form method="post"><input type="email" required="required" name="subscribe_email"><input type="submit"></form>) 


&confirm - Нужно ли подтверждение на почту 
(по умолчанию 1 - да)

&method - Метод отправи письма 
(по умолчанию modxmail)

&subject_subscribe  - Тема подтверждения 
(по умолчанию @CODE: Подтверждения подписки на сайте [+site_name+])

&confirm_text - Текст подтверждающей подписки. [+subscribe_link+] - ссылка для подтверждения ящика. 
(По умолчнаию  (@CODE: <p>Для завершения подписки на сайте [+site_name+] перейдите - <a href="[+subscribe_link+]">по ссылке</a></p>)

&replace - Заменять форму результатом 
(по умолчанию - 1 - да)

&yet_subscribe - Результат если уже есть подписка 
(по умолчанию @CODE: <p>Вы уже подписаны</p>)

&wrong_email - сообщение о некорректном email 
(по умолчанию @CODE: <p>Некорректный адрес электронной почты</p>)

&success_subscribe - сообщение об успешной подписке 
(по умолчанию @CODE: <p>Вы успешно подписались!</p>)

## Плагин:
Страница удачной подписки - id страницы куда пользователь идет после подписки
Страница отписки - id страницы куда пользователь идет после отписки
Метод отправи - каикм образом отправлять письма
Тема успешной подписки, Чанк с текстом письма об успешной подписке, Тема успешной отписки,Чанк с текстом письма об успешной подписке - понятно из названия.


## События для плагинов:
OnELUserSubscription - после добавления пользователя в таблицу, содержит поля формы и id пользователя
OnELConfirmingUsersSubscription - подтверждение подписки пользователя, доступны uid и email
OnELConfirmingUsersUnsubscribe - подтверждение отписки пользователя, доступны uid и email
OnBeforeDistribution - до начала рассылки, доступен id_letter
OnAfterDistribution - по окончанию рассылки, доступен id_letter
